{"version":3,"names":["_common","require","_httpCore","_lodash","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf2","default","result","NewTarget","constructor","_Reflect$construct","arguments","apply","_possibleConstructorReturn2","Reflect","sham","Proxy","Boolean","prototype","valueOf","call","e","strings","_weakMap","UserAgentInterceptor","exports","_Interceptor","_inherits2","_super","_this","options","length","undefined","_classCallCheck2","appName","get","appVersion","set","_assertThisInitialized2","concat","_createClass2","key","value","onRequest","inBrowser","headers","create","webex","Interceptor"],"sources":["user-agent.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {inBrowser} from '@webex/common';\nimport {Interceptor} from '@webex/http-core';\nimport {get} from 'lodash';\n\nconst strings = new WeakMap();\n\n/**\n * Sets a 'user-agent' header on all requests if one is not present.\n * Defaults to '@webex/http-core' though a custom user-agent can be set\n * using the appName and appVersion configuration. e.g.\n *\n *   webex = WebexSdk.init({\n *     credentials: {\n *       supertoken: superToken\n *     },\n *     config: {\n *       credentials: {\n *         client_id,\n *         client_secret\n *       },\n *       appName: 'custom-user-agent',\n *       appVersion: '1.0',\n *     }\n *   });\n */\nexport default class UserAgentInterceptor extends Interceptor {\n  /**\n   * @param {Object} [options={}]\n   * @param {WebexCore} [options.webex]\n   * @private\n   * @returns {UserAgentInterceptor}\n   */\n  constructor(options = {}) {\n    const appName = get(options, 'webex.config.appName');\n    const appVersion = get(options, 'webex.config.appVersion') || '0.0';\n\n    super(options);\n    if (appName) {\n      strings.set(this, `${appName}/${appVersion}`);\n    } else {\n      strings.set(this, '@webex/http-core'); // Using the traditional default from http-core\n    }\n  }\n\n  /**\n   * @returns {UserAgentInterceptor}\n   */\n  static create() {\n    return new UserAgentInterceptor({webex: this});\n  }\n\n  /**\n   * @see Interceptor#onRequest\n   * @param {Object} options\n   * @returns {Object}\n   */\n  onRequest(options) {\n    // Do not set a custom user-agent for browsers\n    if (inBrowser) {\n      return options;\n    }\n\n    options.headers = options.headers || {};\n\n    if ('user-agent' in options.headers && options.headers['spark-user-agent']) {\n      return options;\n    }\n\n    options.headers['user-agent'] = strings.get(this);\n\n    return options;\n  }\n}\n"],"mappings":"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"}