{"version":3,"names":["_fs","require","_path","_fileType","_common","ownKeys","e","r","t","_Object$keys","_Object$getOwnPropertySymbols","o","filter","_Object$getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","Object","forEach","_defineProperty2","default","_Object$getOwnPropertyDescriptors","_Object$defineProperties","_Object$defineProperty","fetchWithoutMagic","exports","filename","_promise","resolve","reject","filepath","join","__dirname","readFile","err","data","name","fetch","then","all","fromFile","_ref","_ref2","_slicedToArray2","type","mime","Error","isBufferLike","file","isBuffer","isBlobLike","isMatchingFile","left","right","equals","i"],"sources":["file.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {readFile} from 'fs';\nimport {join} from 'path';\n\nimport {fromFile} from 'file-type';\nimport {isBuffer} from '@webex/common';\n\nexport const fetchWithoutMagic = (filename) =>\n  new Promise((resolve, reject) => {\n    const filepath = join(__dirname, '../../../@webex/test-helper-server/static', filename);\n\n    readFile(filepath, (err, data) => {\n      if (err) {\n        reject(err);\n\n        return;\n      }\n      resolve({...data, name: filename});\n    });\n  });\n\nexport const fetch = (filename) =>\n  fetchWithoutMagic(filename)\n    .then((data) => Promise.all([fromFile(data), data]))\n    // .then(([{mime: type}, data]) => {\n    //   console.error(data, type);\n\n    //   return {...data, type};\n    // });\n    .then(([{mime: type}, data]) =>\n      type ? {...data, type} : Promise.reject(new Error('Invalid Media Type'))\n    );\n\nexport const isBufferLike = (file) => isBuffer(file);\n\nexport const isBlobLike = (file) => isBuffer(file);\n\nexport const isMatchingFile = (left, right) => {\n  if (!isBufferLike(left)) {\n    throw new Error('`left` must be a `Buffer`');\n  }\n\n  if (!isBufferLike(right)) {\n    throw new Error('`right` must be a `Buffer`');\n  }\n\n  // Node 10 doesn't have Buffer#equals()\n  if (left.equals) {\n    return Promise.resolve(left.equals(right));\n  }\n\n  if (left.length !== right.length) {\n    return Promise.resolve(false);\n  }\n\n  for (let i = 0; i < left.length; i += 1) {\n    if (left[i] !== right[i]) {\n      return Promise.resolve(false);\n    }\n  }\n\n  return Promise.resolve(true);\n};\n"],"mappings":"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"}